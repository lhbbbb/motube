{% extends 'base.html' %}
{% load bootstrap4 %}


{% block body %}
<div class="container">
  <div>
    <h2>{{ movie.title }}</h2>
    <img src="{{ movie.poster }}" alt="movie_poster" width=30%>
    <div id="desArea">
      <pre id="movieDescript">{{ movie.description }}</pre>
    </div>    
    <p>관객: {{ movie.audi }}</p>
    <p>장르:
      {% for gen in movie.genre.all %}
      {{ gen.name }}
      {% endfor %}
    </p>

  </div>
  <div>
    <h5>리뷰</h5>
    {% if user.is_authenticated %}
    <form action="{% url 'movies:create_review' movie.pk %}" method="POST">
      {% csrf_token %}
      {% bootstrap_form review_form %}
      <input class="btn btn-light" type="submit" value="작성">
    </form>
    {% endif %}
    {% for review in reviews %}
      <form action="{% url 'movies:delete_review' movie.pk review.pk %}" method="POST">
        {{ review.user }} - {{ review.content }} {{ review.score}}점
        {% if user == review.user %}
          {% csrf_token %}
          <button class="btn btn-warning" type="submit">삭제</button>
        {% endif %}
      </form>  
    {% endfor %}
  </div>
</div>

<script>
  test = document.createElement('span')
  test.innerHTML = document.querySelector('#movieDescript').innerText
  document.querySelector('#movieDescript').innerText = ''
  document.querySelector('#movieDescript').append(test)
</script>
{% endblock %}